<!DOCTYPE html>
<html>
    <canvas id="canvas"></canvas>
    <body>
        <script>
            //フィールドサイズ
            const FIELD_COL = 10
            const FIELD_ROW = 20

            //ブロックのサイズ（ピクセル）
            const BLOCK_SIZE = 30

            //ジャンバスサイズ
            const SCREEN_W = BLOCK_SIZE * FIELD_COL
            const SCREEN_H = BLOCK_SIZE * FIELD_ROW

            let canvas = document.getElementById("canvas")
            canvas.width = SCREEN_W
            canvas.height = SCREEN_H
            canvas.style.border = "4px solid #555"
            /** @type {CanvasRenderingContext2D} */
            let context = canvas.getContext("2d")

            let tetro = [
                [0, 0, 0, 0],
                [1, 1, 0, 0],
                [0, 1, 1, 1],
                [0, 0, 0, 0],
            ]

            let tetro_x = 0
            let tetro_y = 0

            //フィールドの中身
            let field = Array(FIELD_ROW).fill().map(u => 
                Array(FIELD_COL).fill(0)
            )

            field[5][8] = 1
            field[19][0] = 1
            field[19][9] = 1

            context.clearRect(0, 0, SCREEN_W, SCREEN_H)
            drawElement(field)
            drawElement(tetro, tetro_x, tetro_y)

            function drawElement(element, x = 0, y = 0) {
                element.forEach((row, rowIdx) => row.forEach((col, colIdx) => {
                    if (col) {
                        let px = (x + colIdx) * BLOCK_SIZE
                        let py = (y + rowIdx) * BLOCK_SIZE
                        context.fillStyle = "red"
                        context.fillRect(px, py, BLOCK_SIZE, BLOCK_SIZE)
                        context.strokeStyle = "black"
                        context.strokeRect(px, py, BLOCK_SIZE, BLOCK_SIZE)
                    }
                }))
            }
            

            document.onkeydown = e => {
                switch (e.keyCode) {
                    case 37: //左
                        tetro_x--
                        break
                    case 38: //上
                        tetro_y--
                        break
                    case 39: //右
                        tetro_x++
                        break
                    case 40: //下
                        tetro_y++
                        break
                    case 32: //スペース
      
                        break
                    default:
                        break
                }
                context.clearRect(0, 0, SCREEN_W, SCREEN_H)
                drawElement(field)
                drawElement(tetro, tetro_x, tetro_y)
            }

            

        </script>
    </body>
</html>